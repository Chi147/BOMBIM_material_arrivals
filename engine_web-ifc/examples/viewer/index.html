<script src="web-ifc-viewer.js"></script>
<html lang="en">
<head>
    <meta http-equiv="Content-Language" content="en">
  </head>
</html>



<head>
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/editor/editor.main.min.css">
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/loader.min.js"></script>

<style>
    body {
        margin: 0px;
        padding: 0px;
        display: flex;
        flex-direction: row;
        overflow: hidden;
        height: 100%;
    }
</style>

<body style="margin:0; overflow:hidden;">
  <!-- Hide the left code panel -->
  <div id="container" style="display:none;"></div>

  <!-- 3D Viewer -->
  <div id="viewer" style="position:relative; width:100%; height:100%;">
    <div id="3dcontainer" style="width:100%; height:100%;"></div>

    <!-- ðŸ”¹ Old control buttons (bottom-right) -->
    <div style="position:absolute; right:12px; bottom:12px; background:#ffffffcc; padding:8px 12px; border-radius:8px; display:flex; gap:8px; align-items:center;">
      <input type="button" id="runcode" value="Run Code"/>
      <input type="file" id="finput">
      <input type="button" id="cmem" value="Clear Memory"/>
      <input type="button" id="rcode" value="Reset Editor"/>
      Log Level:
      <select id="logLevel">
        <option value="6">Off</option>
        <option value="4" selected>Error</option>
        <option value="1">Debug</option>
        <option value="3">Warn</option>
      </select>
    </div>

    <!-- ðŸ”¹ New Material panel (bottom-left) -->
    <div style="position:absolute; left:12px; bottom:12px; background:#ffffffcc; padding:8px 12px; border-radius:8px; display:flex; gap:8px; align-items:center;">
      <label>Room <input id="roomName" value="A001" style="width:80px;"></label>
      <label>Boxes <input id="boxCount" type="number" value="10" min="0" style="width:60px;"></label>
      <button id="btnArrived">Material Arrived</button>
      <button id="btnClearBoxes">Clear Boxes</button>
    </div>
  </div>
</body>


<script>
    // Based on https://jsfiddle.net/developit/bwgkr6uq/ which just works but is based on unpkg.com.
    // Provided by loader.min.js.
    require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs' }});
    window.MonacoEnvironment = { getWorkerUrl: () => proxy };
    let proxy = URL.createObjectURL(new Blob([`
        self.MonacoEnvironment = {
            baseUrl: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min'
        };
        importScripts('https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.20.0/min/vs/base/worker/workerMain.min.js');
    `], { type: 'text/javascript' }));
    require(["vs/editor/editor.main"], function () {
        InitMonaco(monaco);
        let editor = monaco.editor.create(document.getElementById('container'), {
            value: ``,
            language: 'typescript',
            theme: 'vs-dark'
        });
        InitWebIfcViewer(editor);
    });
     /* âœ… NEW SCRIPT TO CONNECT BUTTONS TO YOUR FUNCTIONS */
    const $ = (id) => document.getElementById(id);

    $('btnArrived').onclick = () => {
        const room = $('roomName').value.trim();
        const n = parseInt(($('boxCount').value || '0'), 10);
        // @ts-ignore
        window.__setMaterialsInRoom && window.__setMaterialsInRoom(room, isNaN(n) ? 0 : n);
    };

    $('btnClearBoxes').onclick = () => {
        // @ts-ignore
        window.__clearMaterialBoxes && window.__clearMaterialBoxes();
    };
    /* âœ… END NEW SCRIPT */
</script>